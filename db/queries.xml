<?xml version="1.0"?>
<queries>
  <!-- Table: main -->
	<query name="main.showSearchResults">
		<![CDATA[
			SELECT	 id
			FROM	 main
			WHERE MATCH (subject,body) AGAINST (:search) AND published = '1'
			ORDER BY entrytime DESC LIMIT :offset,:num
		]]>
	</query>

	<query name="main.showEditForm">
		<![CDATA[
			SELECT	subject,
				body
			FROM 	main
			WHERE id = :id
		]]>
	</query>

	<query name="main.addEntryFindSlug">
		<![CDATA[
			SELECT 	slug
			FROM	main
			WHERE	slug=:slug
		]]>
	</query>
  
	<query name="main.addEntry">
		<![CDATA[
			INSERT INTO main (
						subject,
						body,
						entrytime,
						slug,
						published
						)
			VALUES (		:subject,
						:body,
						NOW(),
						:slug,
						:published
						)
		]]>
	</query>

	<query name="main.updateEntryDraft">
		<![CDATA[
			UPDATE 	main
			SET 	body=:body,
				subject=:subject,
				entrytime=NOW(),
				published='0'
			WHERE id=:id
		]]>
	</query>

	<query name="main.updateEntryNotDraft">
		<![CDATA[
			UPDATE 	main
			SET 	body=:body,
				subject=:subject,
				published='1'
			WHERE id=:id
		]]>
	</query>
	
	<query name="main.showEntriesIndex">
		<![CDATA[
			SELECT 	id
			FROM 	main
			WHERE	published = '1'
			ORDER BY entrytime DESC
			LIMIT :num
		]]>
	</query>
	
	<query name="main.showDraftsIndex">
		<![CDATA[
			SELECT 	id
			FROM 	main
			WHERE	published = '0'
			ORDER BY entrytime DESC
			LIMIT :num
		]]>
	</query>

  <!-- Table: comments -->
	<query name="comments.printComment">
		<![CDATA[
			SELECT  name,
				url,
				comment,
				date_format(commenttime, '%M %e, %Y @ %h:%i %p') AS date
			FROM 	comments
			WHERE 	cid = :cid
		]]>
	</query>

	<query name="comments.printComments">
		<![CDATA[
			SELECT 	cid
			FROM 	comments
			WHERE 	pid = :pid
			ORDER BY commenttime ASC
		]]>
	</query>

	<query name="comments.addComment">
		<![CDATA[
			INSERT INTO comments (
						name,
						url,
						comment,
						ip,
						pid,
						commenttime
						)
			VALUES (
						:name,
						:url,
						:comment,
						:ipaddy,
						:pid,
						NOW()
				)
		]]>
	</query>
</queries>
